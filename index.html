<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Alorm by elmehdikarami</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Alorm</h1>
        <h2>Android Lite ORM for SQLite</h2>
        <a href="https://github.com/elmehdikarami/alorm" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h3>
<a name="alorm-android-lite-orm" class="anchor" href="#alorm-android-lite-orm"><span class="octicon octicon-link"></span></a>Alorm (Android Lite ORM)</h3>

<p><img src="http://img15.hostingpics.net/thumbs/mini_276571alorm.jpg" alt="Alorm"></p>

<hr><p>In mobile development with the Android platform, the interaction with the database proves the most difficult thing to maintain.
In addition, on the Android platform, the number of open source Framework in the service very limited and they usually do not cover all the features
From here comes the idea of ​​creating a Framework which will aim to cover all conventional operations such as creating tables, the backup, update and deletion.
The Framework (ALORM) guarantee the creation of tables respecting the integrity constraints from the annotated classes.
The Framework also provides an interface simplifies writing conventional operations of data manipulation (CRUD). </p>

<h2>
<a name="1-introduction" class="anchor" href="#1-introduction"><span class="octicon octicon-link"></span></a>1. Introduction</h2>

<p>Alorm is an open source framework for managing persistent objects in a relational database on the Android platform, to work with ALORM, the first thing to do is download the latest release from here: <a href="https://github.com/elmehdikarami/alorm/releases">https://github.com/elmehdikarami/alorm/releases</a></p>

<p>Then it must be integrated into the "Build Path" from your Android application, this can be done by two methods: </p>

<pre><code>     1. The first is to add the jar to the 'libs' directory. 
     2. The second is to add the jar directly in the build path by following the steps below (case of Eclipse) : 
        * Right click on your project 
        * Select Build Path&gt; Configure Build Path 
        * Click Add External Jars and browse to the jar, and then click OK.
</code></pre>

<h2>
<a name="2-configuring-database" class="anchor" href="#2-configuring-database"><span class="octicon octicon-link"></span></a>2. Configuring DataBase</h2>

<p>To specify to Alorm all informations about the database (name, type, version: in the case of SQLite), create a configuration file named 'alorm.properties' in the root folder 'assets'. Here's an example of 'alorm.properties': </p>

<pre><code>dbName=db.sqlite                        #(database name)
dbType=sqlite                           #(database type)
dbVersion=1                             #(database version)
</code></pre>

<h2>
<a name="3-first-application-with-alorm" class="anchor" href="#3-first-application-with-alorm"><span class="octicon octicon-link"></span></a>3. First application with Alorm</h2>

<p>After creating an Android project (or use an existing project), integrate and create Alorm alorm.properties file defining the parameters of your database, we will see how to define classes of models. Before starting the examples, the table below includes the annotations provided by the Framework and what they were build for :</p>

<table>
<tr>
<th>Annotation</th>
    <th>Attribute</th>
    <th>Default</th>
    <th>Explanation</th>
  </tr>
<tr>
<td>Entity</td>
    <td>table</td>
    <td>Class's name</td>
    <td> Name of the table</td>
  </tr>
<tr>
<td rowspan="8">Collumn</td>
    <td>name</td>
    <td>attribute's name</td>
    <td>Specify the column's name</td>
  </tr>
<tr>
<td>primarykey</td>
    <td>false</td>
    <td>Sets the primary key constraint on a field</td>
  </tr>
<tr>
<td>autoincrement</td>
    <td>false</td>
    <td>Defines the constraint auto_increment on a field</td>
  </tr>
<tr>
<td>notnull</td>
    <td>false</td>
    <td>Sets the constraint 'Not Null' on a field</td>
  </tr>
<tr>
<td>default</td>
    <td>NULL</td>
    <td>Specify a default value to a field</td>
  </tr>
<tr>
<td>attribute_ref</td>
    <td>NULL</td>
    <td>Indicates which list an object belongs</td>
  </tr>
<tr>
<td>oncascade</td>
    <td>false</td>
    <td>Set the action to perform</td>
  </tr>
<tr>
<td>lazy</td>
    <td>true</td>
    <td>activate or not the lazy loading</td>
  </tr>
</table><h2>
<a name="4-examples" class="anchor" href="#4-examples"><span class="octicon octicon-link"></span></a>4. Examples</h2>

<p><strong>Main rule: Each entity must have a default constructor and an ID, and each attribute must have a getter and setter.</strong></p>

<p><strong>The database schema is created automatically using the reflection.</strong></p>

<p>These examples show how to use Alorm in several use cases ! </p>

<h3>
<a name="example-1-" class="anchor" href="#example-1-"><span class="octicon octicon-link"></span></a>Example 1 :</h3>

<p>First define our Car class: </p>

<div class="highlight highlight-java"><pre><span class="nd">@Entity</span><span class="o">(</span><span class="n">table</span> <span class="o">=</span> <span class="s">"carTable"</span><span class="o">)</span> <span class="c1">//Indicate that it is an entity + table name</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Car</span> <span class="o">{</span>
        <span class="nd">@Column</span><span class="o">(</span><span class="n">primarykey</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>  <span class="c1">//Define a primary key</span>
        <span class="kd">private</span> <span class="n">Integer</span> <span class="n">number</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">modele</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">company</span><span class="o">;</span>
        <span class="c1">// getters &amp; setters</span>
</pre></div>

<p>To interact with the database, just get the Session and call the appropriate methods. Here's an example for saving a car: </p>

<div class="highlight highlight-java"><pre>        <span class="n">Car</span> <span class="n">car</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Car</span> <span class="o">();</span>
        <span class="n">car</span><span class="o">.</span><span class="na">setNumber</span><span class="o">(</span><span class="s">"8754"</span><span class="o">);</span>
        <span class="n">car</span><span class="o">.</span><span class="na">setCompany</span><span class="o">(</span><span class="s">"Alorm"</span><span class="o">);</span>
        <span class="n">car</span><span class="o">.</span><span class="na">setModele</span><span class="o">(</span><span class="mi">2014</span><span class="o">);</span>
        <span class="k">try</span><span class="o">{</span>
        <span class="c1">// context references the current Activity</span>
         <span class="n">Session</span> <span class="n">session</span> <span class="o">=</span> <span class="n">SessionFactory</span><span class="o">.</span><span class="na">getSession</span><span class="o">(</span><span class="n">context</span><span class="o">);</span><span class="c1">//get the session using the factory</span>
          <span class="n">session</span><span class="o">.</span><span class="na">open</span><span class="o">();</span>                                    <span class="c1">// open the connection</span>
          <span class="n">session</span><span class="o">.</span><span class="na">beginTransaction</span><span class="o">();</span> <span class="c1">//begin a transaction</span>
          <span class="n">session</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">car</span><span class="o">);</span> <span class="c1">//save the entity</span>
          <span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span><span class="c1">//commit</span>
          <span class="n">session</span><span class="o">.</span><span class="na">close</span><span class="o">();</span> <span class="c1">//close the connection</span>
        <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="n">AlormException</span> <span class="n">e</span><span class="o">){</span>  
          <span class="n">session</span><span class="o">.</span><span class="na">rollBack</span><span class="o">();</span>   
                <span class="o">}</span>
</pre></div>

<p>For other methods, here are some examples of how to use them in a transaction: modify an object: </p>

<div class="highlight highlight-java"><pre>   <span class="n">car</span><span class="o">.</span><span class="na">setCompany</span><span class="o">(</span><span class="s">"Mercedes"</span><span class="o">);</span>
   <span class="n">session</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">car</span><span class="o">);</span>
</pre></div>

<p>Delete an object : </p>

<div class="highlight highlight-java"><pre><span class="n">session</span><span class="o">.</span><span class="na">deleteByPK</span><span class="o">(</span><span class="n">Car</span><span class="o">.</span><span class="na">class</span><span class="o">,</span><span class="s">"8754"</span><span class="o">);</span>
</pre></div>

<p>Find an object using its primary key: </p>

<div class="highlight highlight-java"><pre><span class="n">Car</span> <span class="n">car</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">findByPK</span><span class="o">(</span><span class="n">Car</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"8754"</span><span class="o">);</span>
</pre></div>

<p>Get a list: Return all registered objects : </p>

<div class="highlight highlight-java"><pre><span class="n">List</span><span class="o">&lt;</span><span class="n">Car</span><span class="o">&gt;</span> <span class="n">carList</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getAll</span><span class="o">(</span><span class="n">Car</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">;</span>
</pre></div>

<p>To add one or more conditions to the selection, simply proceed as follows: </p>

<div class="highlight highlight-java"><pre><span class="n">List</span><span class="o">&lt;</span><span class="n">Car</span><span class="o">&gt;</span> <span class="n">carList</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getAll</span><span class="o">(</span><span class="n">Car</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"company = ? and modele = ?"</span><span class="o">,</span> <span class="s">"Mercedes"</span><span class="o">,</span><span class="mi">2014</span><span class="o">)</span> <span class="o">;</span>
</pre></div>

<h3>
<a name="example-2--relation-one-to-one" class="anchor" href="#example-2--relation-one-to-one"><span class="octicon octicon-link"></span></a>Example 2 : Relation One-to-One</h3>

<p>In this example we see the relationship 1-1 (bidirectional and unidirectional): Each person has a car, and each car belongs to one person </p>

<div class="highlight highlight-java"><pre><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Car</span> <span class="o">{</span>
        <span class="nd">@Column</span><span class="o">(</span><span class="n">primarykey</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
        <span class="kd">private</span> <span class="n">Integer</span> <span class="n">number</span><span class="o">;</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">modele</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">company</span><span class="o">;</span>
        <span class="nd">@Column</span><span class="o">(</span><span class="n">onCascade</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
        <span class="kd">private</span> <span class="n">Person</span> <span class="n">person</span><span class="o">;</span>
        <span class="c1">// getters &amp; setters</span>
<span class="o">}</span>
</pre></div>

<div class="highlight highlight-java"><pre><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Person</span> <span class="o">{</span>
        <span class="nd">@Column</span><span class="o">(</span><span class="n">primarykey</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
        <span class="kd">private</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">firstName</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">lastName</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">Car</span> <span class="n">car</span><span class="o">;</span>
        <span class="c1">//getters &amp; setters</span>
<span class="o">}</span>
</pre></div>

<p><b>In this case we have a bidirectional relationship, to make it unidictional, simply remove the arrribute person or car.</b></p>

<ul>
<li>Cascade : Allows you to add, modify and delete object(Collection) in cascade, just add the (onCascade = true) annotation on the attribute (Collection) desired. </li>
</ul><h3>
<a name="example-3--ralation-one-to-many-" class="anchor" href="#example-3--ralation-one-to-many-"><span class="octicon octicon-link"></span></a>Example 3 : Ralation One-to-Many :</h3>

<p>Continuing the previous example, and assume that a person can have several cars. So just replace the attribute</p>

<div class="highlight highlight-java"><pre>    <span class="kd">private</span> <span class="n">Car</span> <span class="n">car</span><span class="o">;</span>
</pre></div>

<pre><code>By
</code></pre>

<div class="highlight highlight-java"><pre>    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Car</span><span class="o">&gt;</span> <span class="n">cars</span><span class="o">;</span>
</pre></div>

<p><b>Lazy Loading</b> : To disable the lazy loading on an attribute (object/collection) just proceed as below : </p>

<div class="highlight highlight-java"><pre><span class="nd">@Column</span><span class="o">(</span><span class="n">lazy</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
<span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Car</span><span class="o">&gt;</span> <span class="n">cars</span>
</pre></div>

<p><b>Several lists</b> : One of the cases that may be possible is to have two or more collections of the same class : <br><b>1. Unidirectional : </b></p>

<div class="highlight highlight-java"><pre><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Person</span><span class="o">{</span>
  <span class="nd">@Column</span><span class="o">(</span><span class="n">primarykey</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
  <span class="kd">private</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">firstName</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">lastName</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Car</span><span class="o">&gt;</span> <span class="n">forSale</span>
  <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Car</span><span class="o">&gt;</span> <span class="n">forRent</span><span class="o">;</span>
<span class="c1">//getters &amp; setters</span>
<span class="o">}</span>
</pre></div>

<p><b>2. Bidirectional : </b> To make it bidirectional, just add the annotation <a href="https://github.com/Column" class="user-mention">@Column</a>(attribut_ref = "forSale") to the attribute </p>

<div class="highlight highlight-java"><pre><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Car</span> <span class="o">{</span>
<span class="o">...</span>
  <span class="nd">@Column</span><span class="o">(</span><span class="n">attribute_ref</span><span class="o">=</span><span class="s">"forSale"</span><span class="o">)</span>
  <span class="kd">private</span> <span class="n">Person</span> <span class="n">person</span><span class="o">;</span>
        <span class="c1">// getters &amp; setters</span>
<span class="o">}</span>
</pre></div>

<p><b>This solution can also cover the case of multiple objects</b></p>

<h3>
<a name="example-4--relation-many-to-many-" class="anchor" href="#example-4--relation-many-to-many-"><span class="octicon octicon-link"></span></a>Example 4 : Relation Many-to-Many :<br>
</h3>

<p>Continuing the previous example, suppose that each person can have one or more cars, and each car belongs to one or more persons in this case each class must have a collection of the other class. </p>

<div class="highlight highlight-java"><pre><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Car</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span> <span class="n">persones</span>
<span class="c1">// getters &amp; setters + attributs</span>
<span class="o">}</span>
</pre></div>

<div class="highlight highlight-java"><pre><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Person</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Car</span><span class="o">&gt;</span> <span class="n">cars</span><span class="o">;</span>
<span class="c1">//getters &amp; setters + attributs</span>
<span class="o">}</span>
</pre></div>

<h3>
<a name="example-5--inheritance--" class="anchor" href="#example-5--inheritance--"><span class="octicon octicon-link"></span></a>Example 5 : Inheritance : <br>
</h3>

<p>Alorm support also the notion of inheritance. Each class has its own table, so that the specific attributes of the subclass can have the Not Null constraint </p>

<div class="highlight highlight-java"><pre><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Person</span> <span class="o">{</span>
  <span class="nd">@Column</span><span class="o">(</span><span class="n">primarykey</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
  <span class="kd">private</span> <span class="n">Integer</span> <span class="n">idP</span><span class="o">;</span>
<span class="c1">// getters &amp; setters</span>
<span class="o">}</span>


<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Student</span> <span class="kd">extends</span> <span class="n">Person</span> 
  <span class="nd">@Column</span><span class="o">(</span><span class="n">primarykey</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
  <span class="kd">private</span> <span class="n">Integer</span> <span class="n">idE</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
<span class="c1">// getters &amp; setters + attributs</span>
<span class="o">}</span>
</pre></div>

<h3>
<a name="example-6--custom-queries--" class="anchor" href="#example-6--custom-queries--"><span class="octicon octicon-link"></span></a>Example 6 : Custom queries : <br>
</h3>

<p>Alorm allows the developers to run custom queries, leaving to the developer the possibiliy to execute native SQL query : </p>

<div class="highlight highlight-java"><pre><span class="n">Cursor</span> <span class="n">cursor</span> <span class="o">=</span>  <span class="n">session</span><span class="o">.</span><span class="na">querySql</span><span class="o">(</span><span class="n">String</span> <span class="s">"select * from Car where modele = ?"</span><span class="o">,</span><span class="s">"2014"</span><span class="o">);</span> <span class="c1">// You can add conditions as much as you want</span>
<span class="n">session</span><span class="o">.</span><span class="na">execSql</span><span class="o">(</span><span class="s">"delete from Car where modele = 2014"</span><span class="o">);</span>
</pre></div>

<h3>
<a name="example-7--alormtemplate--" class="anchor" href="#example-7--alormtemplate--"><span class="octicon octicon-link"></span></a>Example 7 : AlormTemplate : <br>
</h3>

<p>This concept comes to simplify the use of the session, for example if you want to do a single operation (add, modify, delete), then you must open a session, start a transaction, commit and close the session.<br>
To avoid this repetition we thought to introduce the notion of template </p>

<div class="highlight highlight-java"><pre><span class="n">AlormTemplate</span> <span class="n">template</span> <span class="o">=</span> <span class="n">AlormTemplate</span><span class="o">.</span><span class="na">getTemplate</span><span class="o">(</span><span class="n">conext</span><span class="o">)</span> <span class="o">;</span>
<span class="n">template</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">car</span><span class="o">);</span> <span class="c1">//After calling save, the car object is already saved !</span>
</pre></div>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/elmehdikarami/alorm/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/elmehdikarami/alorm/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/elmehdikarami/alorm"></a> is maintained by <a href="https://github.com/elmehdikarami">elmehdikarami</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-42570165-2");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>